<?xml-model href="./FactDictionaryModule.rng"?>
<FactDictionaryModule>
  <Facts>

    <Fact path="/taxExemptInterest">
      <Name>Tax Exempt Interest</Name>
      <Description>Tax exempt interest income to report on line 2a of Form 1040. N.B. We write this to box 2a, but then
        never use it again outside of calculating EITC eligibility and SSB taxibility</Description>
      <Export downstreamFacts="true" mef="true" />

      <Derived>
        <Round>
          <CollectionSum>
            <Dependency path="/interestReports/*/taxExemptInterest" />
          </CollectionSum>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/interestIncome">
      <Name>Interest income</Name>
      <Description>Taxable interest income to report on line 2b of Form 1040.</Description>
      <Export downstreamFacts="true" mef="true" />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <Dependency path="/requiresScheduleB" />
              </When>
              <Then>
                <CollectionSum>
                  <!-- We're intentionally summing rounded numbers because that is what Schedule B requires:
                  https://git.irslabs.org/irslabs-prototypes/direct-file/-/issues/8375 -->
                  <Dependency path="/interestReports/*/roundedTaxableInterest" />
                </CollectionSum>
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <CollectionSum>
                  <Dependency path="/interestReports/*/taxableInterest" />
                </CollectionSum>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/netInvestmentIncomeThresholdForMfs">
      <Name>Net investment income threshold for MFS filing status</Name>
      <Description>The max income before someone is eligible to pay net investment income tax</Description>

      <Derived>
        <Dollar>125000</Dollar>
      </Derived>
    </Fact>

    <Fact path="/netInvestmentIncomeThresholdForMfjOrQss">
      <Name>Net investment income threshold for MFJ or QSS filing status</Name>
      <Description>The max income before someone is eligible to pay net investment income tax</Description>

      <Derived>
        <Dollar>250000</Dollar>
      </Derived>
    </Fact>

    <Fact path="/netInvestmentIncomeThresholdForSingleOrHoh">
      <Name>Net investment income threshold for Single or HOH filing status</Name>
      <Description>The max income before someone is eligible to pay net investment income tax</Description>

      <Derived>
        <Dollar>200000</Dollar>
      </Derived>
    </Fact>

    <Fact path="/hasInterestIncomeAndAgiAboveThresholdForMfs">
      <Name>Net investment income disqualifier for MFS</Name>
      <Description>Checks to see if you may need to file for net investment income taxes and thus disqualifies you for
        Direct File</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <All>
          <!-- We only knockout the filer after they've seen the deduction screens, since that's when they verify their
                final AGI -->
          <Dependency module="flow" path="/flowHasSeenDeductions" />
          <Dependency module="filingStatus" path="/isFilingStatusMFS" />
          <GreaterThan>
            <Left>
              <Dependency path="/interestIncome" />
            </Left>
            <Right>
              <Dollar>0</Dollar>
            </Right>
          </GreaterThan>
          <GreaterThan>
            <Left>
              <Dependency module="taxCalculations" path="/agi" />
            </Left>
            <Right>
              <Dependency path="/netInvestmentIncomeThresholdForMfs" />
            </Right>
          </GreaterThan>
        </All>
      </Derived>
    </Fact>

    <Fact path="/hasInterestIncomeAndAgiAboveThresholdForMfjOrQss">
      <Name>Net investment income disqualifier for MFJ or QSS</Name>
      <Description>Checks to see if you may need to file for net investment income taxes and thus disqualifies you for
        Direct File</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <All>
          <!-- We only knockout the filer after they've seen the deduction screens, since that's when they verify their
                final AGI -->
          <Dependency module="flow" path="/flowHasSeenDeductions" />
          <Any>
            <Dependency module="filingStatus" path="/isFilingStatusMFJ" />
            <Dependency module="filingStatus" path="/isFilingStatusQSS" />
          </Any>
          <GreaterThan>
            <Left>
              <Dependency path="/interestIncome" />
            </Left>
            <Right>
              <Dollar>0</Dollar>
            </Right>
          </GreaterThan>
          <GreaterThan>
            <Left>
              <Dependency module="taxCalculations" path="/agi" />
            </Left>
            <Right>
              <Dependency path="/netInvestmentIncomeThresholdForMfjOrQss" />
            </Right>
          </GreaterThan>
        </All>
      </Derived>
    </Fact>

    <Fact path="/hasInterestIncomeAndAgiAboveThresholdForSingleOrHoh">
      <Name>Net investment income disqualifier for or Single or HOH</Name>
      <Description>Checks to see if you may need to file for net investment income taxes and thus disqualifies you for
        Direct File</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <All>
          <!-- We only knockout the filer after they've seen the deduction screens, since that's when they verify their
                final AGI -->
          <Dependency module="flow" path="/flowHasSeenDeductions" />
          <Any>
            <Dependency module="filingStatus" path="/isFilingStatusSingle" />
            <Dependency module="filingStatus" path="/isFilingStatusHOH" />
          </Any>
          <GreaterThan>
            <Left>
              <Dependency path="/interestIncome" />
            </Left>
            <Right>
              <Dollar>0</Dollar>
            </Right>
          </GreaterThan>
          <GreaterThan>
            <Left>
              <Dependency module="taxCalculations" path="/agi" />
            </Left>
            <Right>
              <Dependency path="/netInvestmentIncomeThresholdForSingleOrHoh" />
            </Right>
          </GreaterThan>
        </All>
      </Derived>
    </Fact>


    <Fact path="/interestReports">
      <Name>Interest income</Name>
      <Description>Interest income, with or without a Form 1099-INT.</Description>

      <Writable>
        <Collection />
      </Writable>
    </Fact>

    <Fact path="/minimumInterestIncome">
      <Name>Minimum Interest Income</Name>
      <Description>Miniumum dollar amount needed where someone will get a 1099-INT form</Description>
      <Derived>
        <Dollar>10</Dollar>
      </Derived>
    </Fact>

    <Fact path="/maximumTaxableInterestIncomeBeforeScheduleB">
      <Name>Maximum Taxable Interest Income Before Schedule B</Name>
      <Description>The maximum interest income allowed before Schedule B is required.</Description>

      <Derived>
        <Dollar>1500</Dollar>
      </Derived>
    </Fact>

    <Fact path="/interestReportsIsDone">
      <Name>interestReportsIsIsDone is Done</Name>
      <Description>The user has clicked "Done" for their interestReportsIsIsDone</Description>
      <Export downstreamFacts="true" />
      <Writable>
        <Boolean />
      </Writable>
      <Placeholder>
        <False />
      </Placeholder>
    </Fact>

    <Fact path="/primaryFilerHasIncompleteInterestReports">
      <Name>At least one of Primary Filer's interest reports are incomplete</Name>
      <Description>Whether at least one of Primary Filer's interest reports are incomplete</Description>
      <BlockSubmissionOnTrue />

      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <All>
                <Dependency path="/interestReports/*/belongsToPrimaryFiler" />
                <Not>
                  <Dependency path="/interestReports/*/isComplete" />
                </Not>
              </All>
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerHasIncompleteInterestReports">
      <Name>At least one of Secondary Filer's interest reports are incomplete</Name>
      <Description>Whether at least one of Secondary Filer's interest reports are incomplete</Description>
      <BlockSubmissionOnTrue />

      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <All>
                <Dependency path="/interestReports/*/belongsToSecondaryFiler" />
                <Not>
                  <Dependency path="/interestReports/*/isComplete" />
                </Not>
              </All>
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/hasInterestReports">
      <Name>Has interest reports</Name>
      <Description>Whether the TP has any interest reports</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <CollectionSize>
              <Dependency path="/interestReports" />
            </CollectionSize>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/hasSeenLastAvailableScreen">
      <Name>Has seen last available screen</Name>
      <Description>The user has gone through the entire flow of interest screens</Description>

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/isComplete">
      <Name>Is complete</Name>
      <Description>Whether the interest report is complete.</Description>

      <Derived>
        <All>
          <IsComplete>
            <!-- Without this completeness check, `isComplete` resolves as incomplete, instead of false -->
            <Dependency path="../hasSeenLastAvailableScreen" />
          </IsComplete>
          <Dependency path="../hasSeenLastAvailableScreen" />
          <IsComplete>
            <Dependency path="../taxableInterest" />
          </IsComplete>
          <IsComplete>
            <Dependency path="../taxWithheld" />
          </IsComplete>
          <Any>
            <!-- Either withholding is 0, or we collect a payer TIN -->
            <Equal>
              <Left>
                <Dependency path="../taxWithheld" />
              </Left>
              <Right>
                <Dollar>0</Dollar>
              </Right>
            </Equal>
            <IsComplete>
              <Dependency path="../payer/tin" />
            </IsComplete>
          </Any>
        </All>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/has1099">
      <Name>Has 1099</Name>
      <Description>Whether there is a Form 1099-INT for this interest income.</Description>
      <Export stateSystems="true" />

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/factaFilingRequired">
      <Name>Has FACTA filing requirement box checked</Name>
      <Description>Whether there is a Form 1099-INT with the FACTA filing requirement box checked</Description>

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/interestReports/hasRequiredFactaFilings">
      <Name>Has required FACTA filings</Name>
      <Description>Whether any of the 1099-INT forms have a required FACTA filing box checked</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <All>
                <IsComplete>
                  <Dependency path="/interestReports/*/factaFilingRequired" />
                </IsComplete>
                <Dependency path="/interestReports/*/factaFilingRequired" />
                <!-- Ensures modifying an existing interest report doesn't cause issues -->
                <IsComplete>
                  <Dependency path="/interestReports/*/has1099" />
                </IsComplete>
                <Dependency path="/interestReports/*/has1099" />
              </All>
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/filer">
      <Name>Filer</Name>
      <Description>The taxpayer who received the interest income.</Description>

      <Writable>
        <CollectionItem collection="/filers" />
      </Writable>
      <Placeholder>
        <Dependency path="/primaryFiler" />
      </Placeholder>
    </Fact>

    <Fact path="/interestReports/*/belongsToPrimaryFiler">
      <Name>Interest report belongs to primary filer</Name>
      <Description>The interest report belongs to the primary filer</Description>

      <Derived>
        <Equal>
          <Left>
            <Dependency path="../filer" />
          </Left>
          <Right>
            <Dependency module="filers" path="/primaryFiler" />
          </Right>
        </Equal>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/belongsToSecondaryFiler">
      <Name>Interest report belongs to secondary filer</Name>
      <Description>The interest report belongs to the secondary filer</Description>

      <Derived>
        <Equal>
          <Left>
            <Dependency path="../filer" />
          </Left>
          <Right>
            <Dependency module="filers" path="/secondaryFiler" />
          </Right>
        </Equal>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/secondaryFilerUsedWithoutMFJ">
      <Name>Secondary filer has interest reports when primary filer is not filing jointly</Name>
      <Description>Whether secondary filer has interest reports when primary filer is not filing jointly</Description>

      <Derived>
        <All>
          <Not>
            <Dependency module="filingStatus" path="/isFilingStatusMFJ" />
          </Not>
          <Dependency path="../belongsToSecondaryFiler" />
        </All>
      </Derived>
    </Fact>

    <Fact path="/interestReports/secondaryFilerUsedWithoutMFJ">
      <Name>Secondary filer has interest reports when primary filer is not filing jointly</Name>
      <Description>Whether secondary filer has interest reports when primary filer is not filing jointly</Description>
      <BlockSubmissionOnTrue />

      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <Dependency path="/interestReports/*/secondaryFilerUsedWithoutMFJ" />
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/recipientTin">
      <Description>The recipient's TIN</Description>
      <Export stateSystems="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="../belongsToPrimaryFiler" />
            </When>
            <Then>
              <Dependency module="filers" path="/primaryFiler/tin" />
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency path="../belongsToSecondaryFiler" />
            </When>
            <Then>
              <Dependency module="filers" path="/secondaryFiler/tin" />
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/payer">
      <Name>Payer</Name>
      <Description>The entity that paid the interest income, used on Form 1040 Schedule B, Part 1, Line 1</Description>
      <Export mef="true" stateSystems="true" />

      <Writable>
        <String />
        <Limit type="Match">
          <String><![CDATA[(([A-Za-z0-9#\-\(\)]|&|')\s?)*([A-Za-z0-9#\-\(\)]|&|')]]></String>
        </Limit>
        <Limit type="MaxLength">
          <Int>75</Int>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/writablePayerNameLine2">
      <Name>Payer</Name>
      <Description>The entity that paid the interest income, used on Form 1040 Schedule B, Part 1, Line 2</Description>

      <Writable>
        <String />
        <Limit type="Match">
          <String><![CDATA[(([A-Za-z0-9#/%\-\(\)]|&|')\s?)*([A-Za-z0-9#/%\-\(\)]|&|')]]></String>
        </Limit>
        <Limit type="MaxLength">
          <Int>75</Int>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/payerNameLine2">
      <Name>Payer</Name>
      <Description>The entity that paid the interest income, used on Form 1040 Schedule B, Part 1, Line 2</Description>
      <Export mef="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../writablePayerNameLine2" />
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../writablePayerNameLine2" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <String />
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/payer/tin">
      <Name>TIN</Name>
      <Description>
        The taxpayer identification number of the payer on the interest report.
      </Description>
      <Export mef="true" stateSystems="true" />

      <Writable>
        <EIN />
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/writable1099Amount">
      <Name>1099 Amount of interest income</Name>
      <Description>Box 1 on the 1099-INT.

        This is the writable optional fact. Can be left incomplete. Please use the
        derived fact in downstream calculations.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/1099Amount">
      <Name>1099 Amount of interest income</Name>
      <Description>
        Box 1 on the 1099-INT.
      </Description>
      <Export stateSystems="true" />
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../writable1099Amount" />
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../writable1099Amount" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/writableEarlyWithdrawlPenaltyAmount">
      <Name>1099 Early Withdrawl Penalty Amount</Name>
      <Description>Box 2 on the 1099-INT.

        This is the writable optional fact. Can be left incomplete. Please use the
        derived fact in downstream calculations.</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/earlyWithdrawlPenaltyAmount">
      <Name>1099 Early Withdrawl Penalty Amount</Name>
      <Description>
        Box 2 on the 1099-INT.
      </Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../writableEarlyWithdrawlPenaltyAmount" />
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../writableEarlyWithdrawlPenaltyAmount" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/flowKnockoutHasEarlyWithdrawlPenalty">
      <Name>Knockout Has Early Withdrawl Penalty</Name>
      <Description>Whether user is knocked out for having a early withdrawl penalty. Happens if the user has more than
        $0 in early withdrawl penalty (box 2) across all their 1099-INTs.</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <CollectionSum>
              <Dependency path="/interestReports/*/earlyWithdrawlPenaltyAmount" />
            </CollectionSum>
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/writableSpecifiedPrivateActivityBondInterest">
      <Name>1099 Specified Private Activity Bond Interest</Name>
      <Description>Box 9 on the 1099-INT.

        This is the writable optional fact. Can be left incomplete. Please use the
        derived fact in downstream calculations.</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/specifiedPrivateActivityBondInterest">
      <Name>1099 Specified Private Activity Bond Interest</Name>
      <Description>
        Box 9 on the 1099-INT.
      </Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../writableSpecifiedPrivateActivityBondInterest" />
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../writableSpecifiedPrivateActivityBondInterest" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/writableMarketDiscount">
      <Name>1099 Market Discount</Name>
      <Description>Box 10 on the 1099-INT.

        This is the writable optional fact. Can be left incomplete. Please use the
        derived fact in downstream calculations.</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/marketDiscount">
      <Name>1099 Market Discount</Name>
      <Description>
        Box 10 on the 1099-INT.
      </Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../writableMarketDiscount" />
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../writableMarketDiscount" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/writableBondPremium">
      <Name>1099 Bond Premium</Name>
      <Description>Box 11 on the 1099-INT.

        This is the writable optional fact. Can be left incomplete. Please use the
        derived fact in downstream calculations.</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/bondPremium">
      <Name>1099 Bond Premium</Name>
      <Description>
        Box 11 on the 1099-INT.
      </Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../writableBondPremium" />
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../writableBondPremium" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/writableBondPremiumOnTreasuryObligations">
      <Name>1099 Bond Premium on Treasury Obligations</Name>
      <Description>Box 12 on the 1099-INT.

        This is the writable optional fact. Can be left incomplete. Please use the
        derived fact in downstream calculations.</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/bondPremiumOnTreasuryObligations">
      <Name>1099 Bond Premium on Treasury Obligations</Name>
      <Description>
        Box 12 on the 1099-INT.
      </Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../writableBondPremiumOnTreasuryObligations" />
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../writableBondPremiumOnTreasuryObligations" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/writableBondPremiumOnTaxExemptBond">
      <Name>1099 Bond Premium on Tax Exempt Bond</Name>
      <Description>Box 13 on the 1099-INT.

        This is the writable optional fact. Can be left incomplete. Please use the
        derived fact in downstream calculations.</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/bondPremiumOnTaxExemptBond">
      <Name>1099 Bond Premium on Tax Exempt Bond</Name>
      <Description>
        Box 13 on the 1099-INT.
      </Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../writableBondPremiumOnTaxExemptBond" />
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../writableBondPremiumOnTaxExemptBond" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/writableTaxExemptAndTaxCreditBondCusipNo">
      <Name>1099 Tax Exempt And Tax Credit Bond CUSIP No</Name>
      <Description>Box 14 on the 1099-INT.

        This is the writable optional fact. Can be left incomplete. Please use the
        derived fact in downstream calculations.</Description>

      <Writable>
        <String />
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/taxExemptAndTaxCreditBondCusipNo">
      <Name>1099 Tax Exempt And Tax Credit Bond CUSIP No</Name>
      <Description>
        Box 14 on the 1099-INT.
      </Description>
      <Export stateSystems="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../writableTaxExemptAndTaxCreditBondCusipNo" />
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../writableTaxExemptAndTaxCreditBondCusipNo" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <String />
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/flowKnockoutHasBonds">
      <Name>Knockout Has Bonds</Name>
      <Description>Whether user is knocked out for having a bonds. Happens if the user has more than
        $0 in bonds (boxes 9
        - 13) across all their 1099-INTs.</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <CollectionSum>
              <Add>
                <Dependency path="/interestReports/*/specifiedPrivateActivityBondInterest" />
                <Dependency path="/interestReports/*/marketDiscount" />
                <Dependency path="/interestReports/*/bondPremium" />
                <Dependency path="/interestReports/*/bondPremiumOnTreasuryObligations" />
                <Dependency path="/interestReports/*/bondPremiumOnTaxExemptBond" />
              </Add>
            </CollectionSum>
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/taxableInterest">
      <Name>Taxable interest</Name>
      <Description>Taxable interest, either from box 1 of the 1099-INT or interest reported without a 1099-INT</Description>

      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="../has1099" />
            </When>
            <Then>
              <Add>
                <Dependency path="../interestOnGovernmentBonds" />
                <Dependency path="../1099Amount" />
              </Add>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dependency path="../no1099Amount" />
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/roundedTaxableInterest">
      <Description>Rounded version of taxable interest, may be reported on Form 1040 Schedule B, Part 1, Line 1</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Dependency path="../taxableInterest" />
        </Round>
      </Derived>
    </Fact>

    <Fact path="/hasInterestIncome">
      <Name>Has interest income</Name>
      <Description>Interest income is greater than 0</Description>

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="/interestIncome" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/requiresScheduleB">
      <Description>Whether TP requires schedule B</Description>
      <Export mef="true" />
      <Derived>
        <Any>
          <GreaterThan>
            <Left>
              <CollectionSum>
                <Dependency path="/interestReports/*/taxableInterest" />
              </CollectionSum>
            </Left>
            <Right>
              <Dependency path="/maximumTaxableInterestIncomeBeforeScheduleB" />
            </Right>
          </GreaterThan>
          <Dependency module="income" path="/hasForeignAccountsOrTrusts" />
        </Any>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/writableInterestOnGovernmentBonds">
      <Name>Interest on government bonds</Name>
      <Description>Box 3 on the 1099-INT. This is the writable optional fact. Can be left incomplete. Please use the
        derived fact in downstream calculations.</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>
    <Fact path="/interestReports/*/interestOnGovernmentBonds">
      <Name>Interest on government bonds</Name>
      <Description>Box 3 on the 1099-INT.</Description>
      <Export stateSystems="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency path="../writableInterestOnGovernmentBonds" />
                </IsComplete>
                <Dependency path="../has1099" />
              </All>
            </When>
            <Then>
              <Dependency path="../writableInterestOnGovernmentBonds" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/writableTaxWithheld">
      <Name>(Writable) Federal income tax withheld</Name>
      <Description>Box 4 on the 1099-INT.

        This is the writable optional fact. Can be left incomplete. Please use the
        derived fact in downstream calculations.</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>


    <Fact path="/interestReports/*/taxWithheld">
      <Name>Federal income tax withheld</Name>
      <Description>Comes from box 4 on a 1099-INT. Set to 0 if there is no 1099-INT. We may be able to replace this with
        a default value in the future. Entities that pay interest are required to provide a 1099-INT to anyone from whom
        they withheld interest (https://www.irs.gov/instructions/i1099int#en_US_202201_publink1000275706)</Description>
      <Export downstreamFacts="true" mef="true" stateSystems="true" />
      <ExportZero />

      <Derived>
        <Round>
          <Switch>
            <Case>
              <When>
                <Dependency path="../has1099" />
              </When>
              <Then>
                <Switch>
                  <Case>
                    <When>
                      <All>
                        <IsComplete>
                          <Dependency path="../writableTaxWithheld" />
                        </IsComplete>
                        <Dependency path="../has1099" />
                      </All>
                    </When>
                    <Then>
                      <Dependency path="../writableTaxWithheld" />
                    </Then>
                  </Case>
                  <Case>
                    <When>
                      <True />
                    </When>
                    <Then>
                      <Dollar>0</Dollar>
                    </Then>
                  </Case>
                </Switch>
              </Then>
            </Case>
            <Case>
              <When>
                <True />
              </When>
              <Then>
                <Dollar>0</Dollar>
              </Then>
            </Case>
          </Switch>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/hasFederalWithholding">
      <Description>Controls whether to ask the filer for the payer's TIN if they have a value inside of Box 4 - Federal
        income tax withheld.</Description>

      <Derived>
        <GreaterThan>
          <Left>
            <CollectionSum>
              <Dependency path="../taxWithheld" />
            </CollectionSum>
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/writableForeignTaxPaid">
      <Name>(Writable) Foreign tax paid</Name>
      <Description>Box 6 on the 1099-INT.

        This is the writable optional fact. Can be left incomplete. Please use the
        derived fact in downstream calculations.</Description>

      <Writable>
        <Dollar />
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/foreignTaxPaid">
      <Name>Foreign tax paid</Name>
      <Description>Comes from box 6 on a 1099-INT. Set to 0 if there is no 1099-INT. We may be able to replace this with
        a default value in the future. Entities that pay interest are required to provide a 1099-INT to anyone from whom
        they withheld interest (https://www.irs.gov/instructions/i1099int#en_US_202201_publink1000275706)</Description>

      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="../has1099" />
            </When>
            <Then>
              <Switch>
                <Case>
                  <When>
                    <IsComplete>
                      <Dependency path="../writableForeignTaxPaid" />
                    </IsComplete>
                  </When>
                  <Then>
                    <Dependency path="../writableForeignTaxPaid" />
                  </Then>
                </Case>
                <Case>
                  <When>
                    <True />
                  </When>
                  <Then>
                    <Dollar>0</Dollar>
                  </Then>
                </Case>
              </Switch>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/flowKnockoutHasForeignTaxPaid">
      <Name>Flow Has Foreign Tax Paid</Name>
      <Description>Knocks out the filer if they have value in Box 6 - Foreign Tax Paid.</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <NotEqual>
                <Left>
                  <Dependency path="/interestReports/*/foreignTaxPaid" />
                </Left>
                <Right>
                  <Dollar>0</Dollar>
                </Right>
              </NotEqual>
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/writableTaxExemptInterest">
      <Name>Tax-exempt interest</Name>
      <Description>Box 8 on the 1099-INT.

        This is the writable optional fact. Can be left incomplete. Please use the
        derived fact in downstream calculations.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/taxExemptInterest">
      <Name>Tax-exempt interest</Name>
      <Description>Comes from box 8 on a 1099-INT. Set to 0 if there is no 1099 int. We may be able to replace this with
        a default value in the future.</Description>
      <Export stateSystems="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="../has1099" />
            </When>
            <Then>
              <Switch>
                <Case>
                  <When>
                    <IsComplete>
                      <Dependency path="../writableTaxExemptInterest" />
                    </IsComplete>
                  </When>
                  <Then>
                    <Dependency path="../writableTaxExemptInterest" />
                  </Then>
                </Case>
                <Case>
                  <When>
                    <True />
                  </When>
                  <Then>
                    <Dollar>0</Dollar>
                  </Then>
                </Case>
              </Switch>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/flowKnockoutTaxExemptInterest">
      <Description>Knocks out the filer if they have value in Box 8 - Tax Exempt Interest.</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <NotEqual>
                <Left>
                  <Dependency path="/interestReports/*/taxExemptInterest" />
                </Left>
                <Right>
                  <Dollar>0</Dollar>
                </Right>
              </NotEqual>
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/writableState">
      <Name>State</Name>
      <Description>Box 15 on the 1099-INT.</Description>

      <Writable>
        <Enum optionsPath="/incomeFormStateOptions" />
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/state">
      <Name>State</Name>
      <Description>Alias for writableState to avoid breaking our backend with our convention for optional fields.</Description>

      <Derived>
        <Dependency path="../writableState" />
      </Derived>
    </Fact>

    <Fact path="/flowKnockoutStateTaxWithheld">
      <Name>Flow Knockout State Tax Withheld</Name>
      <Description>Used when the amount entered in box 17 of 1099-INT is greater than zero</Description>
      <Export downstreamFacts="true" />
      <BlockSubmissionOnTrue />
      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <Dependency path="/interestReports/*/hasStateTaxWithheld" />
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/hasStateTaxWithheld">
      <Description>If the user has entered a value of more than zero in box 17 of 1099-INT</Description>
      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="../stateTaxWithheld" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>


    <Fact path="/flowKnockoutWithholdingUnsupportedState">
      <Name>Flow Knockout Withholding Unsupported State</Name>
      <Description>Used to control a knockout for if the filer received withholding of state taxes from a different
        state for any of their 1099Gs.</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <GreaterThan>
          <Left>
            <Count>
              <Dependency path="/interestReports/*/hasKnockoutWithholdingInDifferentState" />
            </Count>
          </Left>
          <Right>
            <Int>0</Int>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/hasKnockoutWithholdingInDifferentState">
      <Name>Has Knockout Withholding In Different State</Name>
      <Description>Checks to see if the withholding of state taxes is from a different state.</Description>

      <Derived>
        <All>
          <IsComplete>
            <Dependency path="../state" />
          </IsComplete>
          <Equal>
            <Left>
              <Dependency path="../state" />
            </Left>
            <Right>
              <Enum optionsPath="/incomeFormStateOptions">differentState</Enum>
            </Right>
          </Equal>
        </All>
      </Derived>
    </Fact>

    <Fact path="/interestReports/*/writableStateIdNumber">
      <Name>State identification number</Name>
      <Description>Box 16 on the 1099-INT.

        This is the writable optional fact. Can be left incomplete. Please use the
        derived fact in downstream calculations.</Description>

      <Writable>
        <String />
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/stateIdNumber">
      <Name>State identification number</Name>
      <Description>Box 16 on the 1099-INT.</Description>
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../writableStateIdNumber" />
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../writableStateIdNumber" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <String />
            </Then>
          </Case>
        </Switch>
      </Derived>

    </Fact>

    <Fact path="/interestReports/*/writableStateTaxWithheld">
      <Name>State tax withheld</Name>
      <Description>Box 17 on the 1099-INT.

        This is the writable optional fact. Can be left incomplete. Please use the
        derived fact in downstream calculations.</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar>0</Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/interestReports/*/stateTaxWithheld">
      <Name>State tax withheld</Name>
      <Description>Box 17 on the 1099-INT.</Description>

      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency path="../writableStateTaxWithheld" />
              </IsComplete>
            </When>
            <Then>
              <Dependency path="../writableStateTaxWithheld" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>

    </Fact>

    <Fact path="/interestReports/*/no1099Amount">
      <Name>Taxable interest</Name>
      <Description>Amount of taxable interest (no Form 1099-INT present).</Description>
      <Export stateSystems="true" />

      <Writable>
        <Dollar />
      </Writable>
      <Placeholder>
        <Dollar>0</Dollar>
      </Placeholder>
    </Fact>

    <Fact path="/primaryFilerInterestReports">
      <Description>Interest reports belonging to the primary filer</Description>

      <Derived>
        <Filter path="/interestReports">
          <Dependency path="belongsToPrimaryFiler" />
        </Filter>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerInterestReportsWith1099Amount">
      <Description>Interest reports belonging to the primary filer that have a 1099Amount</Description>

      <Derived>
        <Filter path="/primaryFilerInterestReports">
          <IsComplete>
            <Dependency path="1099Amount" />
          </IsComplete>
        </Filter>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerInterestReportsWithNo1099Amount">
      <Description>Interest reports belonging to the primary filer that have a no1099Amount</Description>

      <Derived>
        <Filter path="/primaryFilerInterestReports">
          <IsComplete>
            <Dependency path="no1099Amount" />
          </IsComplete>
        </Filter>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerInterestTotal">
      <Description>Total interest amount of the interest reports belonging to the primary filer</Description>

      <Derived>
        <Add>
          <CollectionSum>
            <Dependency path="/primaryFilerInterestReportsWithNo1099Amount/*/no1099Amount" />
          </CollectionSum>
          <CollectionSum>
            <Dependency path="/primaryFilerInterestReportsWith1099Amount/*/1099Amount" />
          </CollectionSum>
        </Add>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerInterestReports">
      <Description>Interest reports belonging to the secondary filer</Description>

      <Derived>
        <Filter path="/interestReports">
          <Dependency path="belongsToSecondaryFiler" />
        </Filter>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerInterestReportsWith1099Amount">
      <Description>Interest reports belonging to the secondary filer that have a 1099Amount</Description>

      <Derived>
        <Filter path="/secondaryFilerInterestReports">
          <IsComplete>
            <Dependency path="1099Amount" />
          </IsComplete>
        </Filter>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerInterestReportsWithNo1099Amount">
      <Description>Interest reports belonging to the secondary filer that have a no1099Amount</Description>

      <Derived>
        <Filter path="/secondaryFilerInterestReports">
          <IsComplete>
            <Dependency path="no1099Amount" />
          </IsComplete>
        </Filter>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerInterestTotal">
      <Description>Total interest amount of the interest reports belonging to the secondary filer</Description>

      <Derived>
        <Add>
          <CollectionSum>
            <Dependency path="/secondaryFilerInterestReportsWithNo1099Amount/*/no1099Amount" />
          </CollectionSum>
          <CollectionSum>
            <Dependency path="/secondaryFilerInterestReportsWith1099Amount/*/1099Amount" />
          </CollectionSum>
        </Add>
      </Derived>
    </Fact>

    <Fact path="/filers/*/interestReportsTotal">
      <Name>total interests</Name>
      <Description>Total interests reported and not reported on Form 1099.</Description>
      <Export stateSystems="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency module="filers" path="../isPrimaryFiler" />
            </When>
            <Then>
              <Dependency path="/primaryFilerInterestTotal" />
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency module="filers" path="../isSecondaryFiler" />
            </When>
            <Then>
              <Dependency path="/secondaryFilerInterestTotal" />
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
  </Facts>
</FactDictionaryModule>
