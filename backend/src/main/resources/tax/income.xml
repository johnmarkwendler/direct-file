<?xml-model href="./FactDictionaryModule.rng"?>
<!-- This module holds income types that do not exist in their own modules -->
<FactDictionaryModule>
  <Facts>
    <Fact path="/incomeSourcesSupported">
      <Name>Income sources supported</Name>
      <Description>Does Direct File support all of the income sources that you/you and your spouse have?</Description>
      <Export downstreamFacts="true" />

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/receivedDigitalAssets">
      <Name>Digital assets</Name>
      <Description>At any time during 2023, did you: (a) receive (as a reward, award, or payment for property or
        services) a digital asset (or a financial interest in a digital asset)?</Description>

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/disposedDigitalAssets">
      <Name>Digital assets</Name>
      <Description>At any time during 2023, did you sell, exchange, gift, or otherwise dispose of a digital asset (or a
        financial interest in a digital asset)?</Description>

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/notDigitalAssets">
      <Name>Not Digital Assets</Name>
      <Description>The TP did not receive receive or dispose of digital assets</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Not>
          <Any>
            <Dependency path="/receivedDigitalAssets" />
            <Dependency path="/disposedDigitalAssets" />
          </Any>
        </Not>
      </Derived>
    </Fact>

    <Fact path="/hasForeignAccounts">
      <Name>Interest of signature authorization in a foreign financial account</Name>
      <Description>At any time during 2023, did you have a financial interest in or signature authority over a financial
        account located in a foreign country?</Description>
      <Export mef="true" />

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/doesNotHaveForeignAccounts">
      <Name>Does not have interest of signature authorization in a foreign financial account</Name>
      <Description>Logical Negation of has foreign accounts</Description>

      <Derived>
        <Not>
          <Dependency path="/hasForeignAccounts" />
        </Not>
      </Derived>
    </Fact>

    <Fact path="/isForeignTrustsGrantor">
      <Name>Is the TP an owner, grantor, settler or trustor of a foreign trust?</Name>
      <Description>At any time during 2023, did you own a foreign trust?</Description>

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/isNotForeignTrustsGrantor">
      <Name>Is the TP NOT an owner, grantor, settler or trustor of a foreign trust?</Name>
      <Description>Logical Negation of has foreign trusts grantor</Description>

      <Derived>
        <Not>
          <Dependency path="/isForeignTrustsGrantor" />
        </Not>
      </Derived>
    </Fact>

    <Fact path="/hasForeignTrustsTransactions">
      <Name>Did the TP have any transactions with a foreign trust?</Name>
      <Description>At any time during 2023, did you have a transaction with a foreign trust?</Description>

      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/doesNotHaveForeignTrustsTransactions">
      <Name>Is the TP NOT an owner, grantor, settler or trustor of a foreign trust?</Name>
      <Description>Logical Negation of has foreign trusts grantor</Description>

      <Derived>
        <Not>
          <Dependency path="/hasForeignTrustsTransactions" />
        </Not>
      </Derived>
    </Fact>

    <Fact path="/isForeignTrustsGrantorOrHasForeignTrustsTransactions">
      <Name>Is the TP an owner, grantor, settler or trustor of a foreign trust OR did the TP have any transactions with
        a foreign trust?</Name>
      <Description>Is the TP an owner, grantor, settler or trustor of a foreign trust OR did the TP have any
        transactions with a foreign trust?</Description>
      <Export mef="true" />

      <Derived>
        <Any>
          <Dependency path="/isForeignTrustsGrantor" />
          <Dependency path="/hasForeignTrustsTransactions" />
        </Any>
      </Derived>
    </Fact>

    <Fact path="/isNotForeignTrustsGrantorAndDoesNotHaveForeignTrustsTransactions">
      <Name>Is the TP NOT an owner, grantor, settler or trustor of a foreign trust AND did the TP NOT have any
        transactions with a foreign trust?</Name>
      <Description>Is the TP NOT an owner, grantor, settler or trustor of a foreign trust AND did the TP NOT have any
        transactions with a foreign trust?</Description>

      <Derived>
        <Not>
          <Dependency path="/isForeignTrustsGrantorOrHasForeignTrustsTransactions" />
        </Not>
      </Derived>
    </Fact>

    <Fact path="/hasForeignAccountsOrTrusts">
      <Description>The TP has interest in foreign accounts or foreign trusts</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Any>
          <Dependency path="/hasForeignAccounts" />
          <Dependency path="/isForeignTrustsGrantorOrHasForeignTrustsTransactions" />
        </Any>
      </Derived>
    </Fact>

    <Fact path="/doesNotHaveForeignAccountsOrTrusts">
      <Name>Not foreign accounts nor foreign trusts</Name>
      <Description>The TP does not have interest in foreign accounts nor does the TP have interest in foreign trusts</Description>

      <Derived>
        <Not>
          <Dependency path="/hasForeignAccountsOrTrusts" />
        </Not>
      </Derived>
    </Fact>

    <Fact path="/madeIraContributions">
      <Name>Made IRA contributions</Name>
      <Description>Whether the TP made contributions to an Individual Retirement Arrangement.</Description>
      <Export downstreamFacts="true" />
      <Writable>
        <Boolean />
      </Writable>
    </Fact>

    <Fact path="/incomeSourcesIsComplete">
      <Name>Income sources complete</Name>
      <Description>The income sources sub-subsection is complete.</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <All>
          <IsComplete>
            <Dependency path="/incomeSourcesSupported" />
          </IsComplete>
          <IsComplete>
            <Dependency path="/notDigitalAssets" />
          </IsComplete>
          <IsComplete>
            <Dependency path="/doesNotHaveForeignAccountsOrTrusts" />
          </IsComplete>
          <IsComplete>
            <Dependency path="/madeIraContributions" />
          </IsComplete>
        </All>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerUnreportedHouseholdWages">
      <Description>
        Primary Filer's Household employee wages not reported on Form(s) W-2

        OUT OF SCOPE
      </Description>

      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerUnreportedHouseholdWages">
      <Description>
        Primary Filer's household employee wages not reported on Form(s) W-2

        OUT OF SCOPE
      </Description>

      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>

    <Fact path="/unreportedHouseholdWages">
      <Name>Unreported household wages</Name>
      <Description>
        Household employee wages not reported on Form(s) W-2

        Form 1040, 1b
      </Description>

      <Derived>
        <Add>
          <Dependency path="/primaryFilerUnreportedHouseholdWages" />
          <Dependency path="/secondaryFilerUnreportedHouseholdWages" />
        </Add>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerUnreportedTipIncome">
      <Description>
        Primary Filer's tip income not reported on line 1a

        OUT OF SCOPE
      </Description>

      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerUnreportedTipIncome">
      <Description>
        Secondary Filer's tip income not reported on line 1a

        OUT OF SCOPE
      </Description>

      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>

    <Fact path="/unreportedTipIncome">
      <Name>Unreported tip income</Name>
      <Description>
        Tip income not reported on line 1a

        Form 1040, (line 1c)
      </Description>

      <Derived>
        <Add>
          <Dependency path="/primaryFilerUnreportedTipIncome" />
          <Dependency path="/secondaryFilerUnreportedTipIncome" />
        </Add>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerMedicareWaiverPayments">
      <Description>
        Primary filer's Medicaid waiver payments not reported on Form(s) W-2

        OUT OF SCOPE
      </Description>

      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerMedicareWaiverPayments">
      <Description>
        Secondary filer's Medicaid waiver payments not reported on Form(s) W-2

        OUT OF SCOPE
      </Description>

      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>

    <Fact path="/medicareWaiverPayments">
      <Name>Medicare Waiver Payments</Name>
      <Description>
        Medicaid waiver payments not reported on Form(s) W-2

        Form 1040 (line 1d)
      </Description>

      <Derived>
        <Add>
          <Dependency path="/primaryFilerMedicareWaiverPayments" />
          <Dependency path="/secondaryFilerMedicareWaiverPayments" />
        </Add>
      </Derived>
    </Fact>


    <Fact path="/taxableDependentCare">
      <Name>Taxable Dependent Care</Name>
      <Description>Taxable dependent care benefits from Form 2441 (line 1e)</Description>
      <Export mef="true" />

      <Derived>
        <Dependency module="cdcc" path="/cdccTaxableBenefits" />
      </Derived>
    </Fact>

    <Fact path="/primaryFilerEmployerProvidedAdoptionBenefits">
      <Description>
        Primary filer's Employer-provided adoption benefits from Form 8839 (line 1f)
      </Description>

      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerEmployerProvidedAdoptionBenefits">
      <Description>
        Secondary filer's employer-provided adoption benefits from Form 8839 (line 1f)
      </Description>

      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>

    <Fact path="/employerProvidedAdoptionBenefits">
      <Name>Employer Provided Adoption Benefits</Name>
      <Description>Employer-provided adoption benefits from Form 8839 (line 1f)</Description>

      <Derived>
        <Add>
          <Dependency path="/primaryFilerEmployerProvidedAdoptionBenefits" />
          <Dependency path="/secondaryFilerEmployerProvidedAdoptionBenefits" />
        </Add>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerWagesFrom8919">
      <Description>
        Primary filer's wages from Form 8919 (line 1g)
      </Description>

      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerWagesFrom8919">
      <Description>
        Secondary filer's wages from Form 8919 (line 1g)
      </Description>

      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>

    <Fact path="/wagesFrom8919">
      <Name>Wages From 8919</Name>
      <Description>Wages from Form 8919 (line 1g)</Description>

      <Derived>
        <Add>
          <Dependency path="/primaryFilerWagesFrom8919" />
          <Dependency path="/secondaryFilerWagesFrom8919" />
        </Add>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerOtherEarnedIncome">
      <Name>Other earned income</Name>
      <Description>Other earned income (line 1h) OUT OF SCOPE.</Description>

      <Derived>
        <Add>
          <!-- TODO We are not yet supporting strike or lockout benefits, excessive elective deferrals, or corrective distributions from a retirement plan. -->
          <!-- <Dependency module="form1099Rs" path="/primaryFilerDisabilityPensionsBeforeMinRetirementAge" /> -->
          <Dollar>0</Dollar>
        </Add>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerOtherEarnedIncome">
      <Name>Other earned income</Name>
      <Description>Other earned income (line 1h) OUT OF SCOPE.</Description>

      <Derived>
        <Add>
          <!-- TODO We are not yet supporting strike or lockout benefits, excessive elective deferrals, or corrective distributions from a retirement plan. -->
          <!-- <Dependency module="form1099Rs" path="/secondaryFilerDisabilityPensionsBeforeMinRetirementAge" /> -->
          <Dollar>0</Dollar>
        </Add>
      </Derived>
    </Fact>

    <Fact path="/otherEarnedIncome">
      <Name>Other earned income</Name>
      <Description>Other earned income (line 1h)</Description>

      <Derived>
        <Add>
          <Dependency path="/primaryFilerOtherEarnedIncome" />
          <Dependency path="/secondaryFilerOtherEarnedIncome" />
        </Add>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerEmployerIncomeSubtotalBase">
      <Description>
        The summed value of line 1a to 1d and 1f to 1h, using only the primary filer's income, but excluding
        any taxable CDCC benefits.
      </Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Add>
          <Dependency module="formW2s" path="/primaryFilerWages" />
          <Dependency path="/primaryFilerUnreportedHouseholdWages" />
          <Dependency path="/primaryFilerUnreportedTipIncome" />
          <Dependency path="/primaryFilerMedicareWaiverPayments" />
          <Dependency path="/primaryFilerEmployerProvidedAdoptionBenefits" />
          <Dependency path="/primaryFilerWagesFrom8919" />
          <Dependency path="/primaryFilerOtherEarnedIncome" />
        </Add>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerEmployerIncomeSubtotalBase">
      <Description>
        The summed value of line 1a to 1d and 1f to 1h, using only the secondary filer's income, but
        excluding any taxable CDCC benefits.
      </Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Add>
          <Dependency module="formW2s" path="/secondaryFilerWages" />
          <Dependency path="/secondaryFilerUnreportedHouseholdWages" />
          <Dependency path="/secondaryFilerUnreportedTipIncome" />
          <Dependency path="/secondaryFilerMedicareWaiverPayments" />
          <Dependency path="/secondaryFilerEmployerProvidedAdoptionBenefits" />
          <Dependency path="/secondaryFilerWagesFrom8919" />
          <Dependency path="/secondaryFilerOtherEarnedIncome" />
        </Add>
      </Derived>
    </Fact>

    <Fact path="/employerIncomeSubtotal">
      <Name>employer income subtotal</Name>
      <Description>
        Is used as earned income for calculating the EITC and CDCC.

        Form 1040, Line 1z
      </Description>
      <Export downstreamFacts="true" mef="true" />
      <Derived>
        <Round>
          <Add>
            <Dependency path="/primaryFilerEmployerIncomeSubtotalBase" />
            <Dependency path="/secondaryFilerEmployerIncomeSubtotalBase" />
            <Dependency path="/taxableDependentCare" />
          </Add>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/qualifiedDividends">
      <Name>Qualified Dividends</Name>
      <Description>Qualified dividend income to report on line 3a of Form 1040.

        OUT OF SCOPE</Description>

      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>

    <Fact path="/ordinaryDividends">
      <Name>Ordinary dividends</Name>
      <Description>Ordinary dividend income to report on line 3b of Form 1040.
        OUT OF SCOPE</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>

    <Fact path="/iraDistributions">
      <Name>IRA distributions</Name>
      <Description>IRA distributions to report on line 4a of Form 1040.
        OUT OF SCOPE</Description>
      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>

    <Fact path="/taxableIraDistributions">
      <Name>Taxable IRA distributions</Name>
      <Description>Taxable IRA distributions to report on line 4b of Form 1040.
        OUT OF SCOPE</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>

    <Fact path="/pensionsAndAnnuities">
      <Name>Pensions And Annuities</Name>
      <Description>Pensions and annuities to report on line 5a of Form 1040.</Description>
      <Export downstreamFacts="true" mef="true" />
      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency module="form1099Rs" path="/form1099Rs" />
              </IsComplete>
            </When>
            <Then>
              <Add>
                <Dependency module="form1099Rs" path="/taxFreePensionRollovers" />
                <Dependency module="form1099Rs" path="/partlyTaxablePensions" />
              </Add>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/taxablePensionsAndAnnuities">
      <Name>Taxable Pensions And Annuities</Name>
      <Description>Taxable pensions and annuities to report on line 5b of Form 1040.</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <IsComplete>
                <Dependency module="form1099Rs" path="/form1099Rs" />
              </IsComplete>
            </When>
            <Then>
              <Add>
                <Dependency module="form1099Rs" path="/fullyTaxablePensions" />
                <Dependency module="form1099Rs" path="/taxableAmountsOfPartiallyTaxablePensions" />
              </Add>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/hasTaxablePensionsAndAnnuities">
      <Description>Taxable pensions and annuities are greater than 0</Description>
      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="/taxablePensionsAndAnnuities" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/taxablePensionsAndAnnuitiesDisplay">
      <Description>A display value for line 5b for the MeF XML and PDF</Description>
      <Export mef="true" />
      <ExportZero />

      <Derived>
        <Switch>
          <Case>
            <!-- taxablePensionsAndAnnuities (Dollar) > 0 THEN 5b is taxablePensionsAndAnnuities (Dollar) -->
            <When>
              <GreaterThan>
                <Left>
                  <Dependency path="/taxablePensionsAndAnnuities" />
                </Left>
                <Right>
                  <Dollar>0</Dollar>
                </Right>
              </GreaterThan>
            </When>
            <Then>
              <Dependency path="/taxablePensionsAndAnnuities" />
            </Then>
          </Case>
          <Case>
            <!-- isTaxFreePensionRollover (Boolean) == true for ANY 1099R AND taxablePensionsAndAnnuities (Dollar) == 0 THEN 5b is $0 -->
            <When>
              <GreaterThan>
                <Left>
                  <Count>
                    <Dependency module="form1099Rs" path="/form1099Rs/*/isTaxFreePensionRollover" />
                  </Count>
                </Left>
                <Right>
                  <Int>0</Int>
                </Right>
              </GreaterThan>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
          <!-- isFullyOrPartlyTaxablePension (Boolean) == false AND isTaxFreePensionRollover (Boolean) == false for ALL 1099R THEN 5b is blank -->
          <!-- Default to incomplete (blank for outputs) -->
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/nonTaxablePensionsAndAnnuities">
      <Description>non taxable pension and annuities, used for calulating part of line 13b on Schedule R</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <Subtract>
          <Minuend>
            <Dependency path="/pensionsAndAnnuities" />
          </Minuend>
          <Subtrahends>
            <Dependency path="/taxablePensionsAndAnnuities" />
          </Subtrahends>
        </Subtract>
      </Derived>
    </Fact>

    <Fact path="/taxablePensionsAndAnnuitiesLiteralCode">
      <Name>Taxable Pensions And Annuities literal code</Name>
      <Description>Indicates when there is a rollover.</Description>
      <Export mef="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency module="form1099Rs" path="/has1099RWithDirectRollover" />
            </When>
            <Then>
              <String>ROLLOVER</String>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/capitalGainsScheduleDNotRequired">
      <Name>Capital Gains Schedule D Not Required</Name>
      <Description>1040 checkbox to be marked when *nonzero* gain/loss is exempt from Schedule D requirement. Capital
        gain/loss is always zero for our TY2023 scope. So, per W&amp;I counsel we should never mark this in TY 2023.
        (Instructions on Form 1040 are poor; see instruction booklet p. 31)
      </Description>
      <Derived>
        <False />
      </Derived>
    </Fact>

    <Fact path="/capitalGainsOrLosses">
      <Name>Capital Gains or Losses</Name>
      <Description>Total capital gains or losses for line 7 of the 1040

        OUT OF SCOPE</Description>
      <Export downstreamFacts="true" />
      <Derived>
        <Dollar>0</Dollar>
      </Derived>
    </Fact>

    <Fact path="/hasOtherIncome">
      <Name>Has Other Income</Name>
      <Description>Does the taxpayer have other income?</Description>

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency path="/otherIncome" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/hasAdjustmentsToIncome">
      <Name>Has Adjustments to Income</Name>
      <Description>Does the taxpayer have adjustments to income reported in Schedule 1 Part 2?</Description>

      <Derived>
        <GreaterThan>
          <Left>
            <Dependency module="taxCalculations" path="/adjustmentsToIncome" />
          </Left>
          <Right>
            <Dollar>0</Dollar>
          </Right>
        </GreaterThan>
      </Derived>
    </Fact>

    <Fact path="/requiresSchedule1">
      <Name>Requires Schedule 1</Name>
      <Description>Does the taxpayer need to file Schedule 1?</Description>
      <Export mef="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <Any>
                <Dependency path="/hasOtherIncome" />
                <Dependency path="/hasAdjustmentsToIncome" />
                <Dependency module="unemployment" path="/receivedUnemploymentCompensation" />
              </Any>
            </When>
            <Then>
              <True />
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/schedule1TotalOtherIncome">
      <Name>Total other income</Name>
      <Description>Total other income reported on line 9 of the 1040 Schedule 1.</Description>
      <Export mef="true" />

      <Derived>
        <Round>
          <Add>
            <Dependency module="form1099Misc" path="/alaskaPfdIncome" />
          </Add>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/otherIncome">
      <Name>Other income from Schedule 1</Name>
      <Description>Other income from Schedule 1, line 10 reported on line 8 of the 1040</Description>
      <Export downstreamFacts="true" mef="true" />

      <Derived>
        <Round>
          <Add>
            <Dependency module="unemployment" path="/unemploymentCompensation" />
            <Dependency path="/schedule1TotalOtherIncome" />
          </Add>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/totalIncome">
      <Name>Total income</Name>
      <Description>Total income to report on line 9 of Form 1040.</Description>
      <Export downstreamFacts="true" mef="true" />

      <Derived>
        <Round>
          <Add>
            <Dependency path="/employerIncomeSubtotal" />
            <Dependency module="interest" path="/interestIncome" />
            <Dependency path="/ordinaryDividends" />
            <Dependency path="/taxableIraDistributions" />
            <Dependency path="/taxablePensionsAndAnnuities" />
            <Dependency module="socialSecurity" path="/taxableSocialSecurityBenefits" />
            <Dependency path="/capitalGainsOrLosses" />
            <Dependency path="/otherIncome" />
          </Add>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/flowHasReportedIncome">
      <Description>Whether the filer has reported any income (even if the reported income is zero)</Description>

      <Derived>
        <Any>
          <Dependency module="formW2s" path="/hasW2s" />
          <Dependency module="unemployment" path="/receivedUnemploymentCompensation" />
          <Dependency module="interest" path="/hasInterestReports" />
          <Dependency module="form1099Misc" path="/has1099Misc" />
          <Dependency module="cdcc" path="/hasReportedDependentCareBenefits" />
          <Dependency module="form1099Rs" path="/has1099R" />
          <Dependency module="socialSecurity" path="/hasSocialSecurityBenefits" />
        </Any>
      </Derived>
    </Fact>

    <Fact path="/flowHasSeenTotalIncomeSummary">
      <Description>Whether the filer has seen the total income summary screen</Description>
      <Export downstreamFacts="true" />

      <Writable>
        <Boolean />
      </Writable>

      <Placeholder>
        <False />
      </Placeholder>
    </Fact>

    <Fact path="/earnedIncomeWithAllCombatPay">
      <Name>Earned income including all combat pay</Name>
      <Description>Earned income plus all combat pay.

        This value is reported on line 18a of schedule 8812, used to
        calculate ACTC.</Description>
      <Export downstreamFacts="true" mef="true" />

      <Derived>
        <Round>
          <Add>
            <Dependency path="/employerIncomeSubtotal" />
            <Dependency module="formW2s" path="/allCombatPay" />
          </Add>
        </Round>
      </Derived>
    </Fact>


    <Fact path="/cdccPrimaryFilerCombatPayForCredits">
      <Name>Combat Pay Included in Primary Filer Earned Income for CDCC</Name>
      <Description>
        Amount of combat pay to include in a primary filer's earned income for Child and Dependent Care
        Credit
      </Description>

      <Derived>
        <Switch>
          <Case>
            <When>
              <Not>
                <All>
                  <Dependency module="formW2s" path="/primaryFilerHasCombatPay" />
                  <Dependency module="cdcc" path="/combatPayCouldImpactCdccCredits" />
                </All>
              </Not>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency module="cdcc" path="/cdccCombatPayElection" />
                </IsComplete>
                <Any>
                  <Equal>
                    <Left>
                      <Dependency module="cdcc" path="/cdccCombatPayElection" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">usePrimaryCombatPay</Enum>
                    </Right>
                  </Equal>
                  <Equal>
                    <Left>
                      <Dependency module="cdcc" path="/cdccCombatPayElection" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">useBothCombatPay</Enum>
                    </Right>
                  </Equal>
                  <Equal>
                    <Left>
                      <Dependency module="cdcc" path="/cdccCombatPayElection" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">usePrimaryNotSpouseCombatPay</Enum>
                    </Right>
                  </Equal>
                </Any>
              </All>
            </When>
            <Then>
              <Dependency module="formW2s" path="/primaryFilerCombatPay" />
            </Then>
          </Case>
          <Case>
            <When>
              <!-- They have made a choice, but that choice did not include including primary combat pay -->
              <IsComplete>
                <Dependency module="cdcc" path="/cdccCombatPayElection" />
              </IsComplete>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
          <!-- Intentionally leave this undefined if there is combat pay but no decision is made -->
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/cdccSecondaryFilerCombatPayForCredits">
      <Name>Combat Pay Included in Secondary Filer Earned Income for CDCC</Name>
      <Description>
        Amount of combat pay to include in a secondary filer's earned income for Child and Dependent Care
        Credit
      </Description>

      <Derived>
        <Switch>
          <Case>
            <When>
              <Not>
                <All>
                  <Dependency module="formW2s" path="/MFJSpouseHasCombatPay" />
                  <Dependency module="cdcc" path="/combatPayCouldImpactCdccCredits" />
                </All>
              </Not>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency module="cdcc" path="/cdccCombatPayElection" />
                </IsComplete>
                <Any>
                  <Equal>
                    <Left>
                      <Dependency module="cdcc" path="/cdccCombatPayElection" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">useSpouseCombatPay</Enum>
                    </Right>
                  </Equal>
                  <Equal>
                    <Left>
                      <Dependency module="cdcc" path="/cdccCombatPayElection" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">useBothCombatPay</Enum>
                    </Right>
                  </Equal>
                  <Equal>
                    <Left>
                      <Dependency module="cdcc" path="/cdccCombatPayElection" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">useSpouseNotPrimaryCombatPay</Enum>
                    </Right>
                  </Equal>
                </Any>
              </All>
            </When>
            <Then>
              <Dependency module="formW2s" path="/MFJSpouseCombatPay" />
            </Then>
          </Case>
          <Case>
            <When>
              <!-- They have made a choice, but that choice did not include including primary combat pay -->
              <IsComplete>
                <Dependency module="cdcc" path="/cdccCombatPayElection" />
              </IsComplete>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
          <!-- Intentionally leave this undefined if there is combat pay but no decision is made -->
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/cdccPrimaryFilerCombatPayForBenefits">
      <Name>Combat Pay Included in Primary Filer Earned Income for CDCC</Name>
      <Description>
        Amount of combat pay to include in a primary filer's earned income for Child and Dependent Care
        Credit
      </Description>

      <Derived>
        <Switch>
          <Case>
            <When>
              <Not>
                <All>
                  <Dependency module="formW2s" path="/primaryFilerHasCombatPay" />
                  <Dependency module="cdcc" path="/combatPayCouldImpactDependentCareBenefits" />
                </All>
              </Not>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency module="cdcc" path="/cdccCombatPayElectionForBenefits" />
                </IsComplete>
                <Any>
                  <Equal>
                    <Left>
                      <Dependency module="cdcc" path="/cdccCombatPayElectionForBenefits" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">usePrimaryCombatPay</Enum>
                    </Right>
                  </Equal>
                  <Equal>
                    <Left>
                      <Dependency module="cdcc" path="/cdccCombatPayElectionForBenefits" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">useBothCombatPay</Enum>
                    </Right>
                  </Equal>
                  <Equal>
                    <Left>
                      <Dependency module="cdcc" path="/cdccCombatPayElectionForBenefits" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">usePrimaryNotSpouseCombatPay</Enum>
                    </Right>
                  </Equal>
                </Any>
              </All>
            </When>
            <Then>
              <Dependency module="formW2s" path="/primaryFilerCombatPay" />
            </Then>
          </Case>
          <Case>
            <When>
              <!-- They have made a choice, but that choice did not include including primary combat pay -->
              <IsComplete>
                <Dependency module="cdcc" path="/cdccCombatPayElectionForBenefits" />
              </IsComplete>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
          <!-- Intentionally leave this undefined if there is combat pay but no decision is made -->
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/cdccSecondaryFilerCombatPayForBenefits">
      <Name>Combat Pay Included in Secondary Filer Earned Income for CDCC</Name>
      <Description>
        Amount of combat pay to include in a secondary filer's earned income for Child and Dependent Care
        Credit
      </Description>

      <Derived>
        <Switch>
          <Case>
            <When>
              <Not>
                <All>
                  <Dependency module="formW2s" path="/MFJSpouseHasCombatPay" />
                  <Dependency module="cdcc" path="/combatPayCouldImpactDependentCareBenefits" />
                </All>
              </Not>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
          <Case>
            <When>
              <All>
                <IsComplete>
                  <Dependency module="cdcc" path="/cdccCombatPayElectionForBenefits" />
                </IsComplete>
                <Any>
                  <Equal>
                    <Left>
                      <Dependency module="cdcc" path="/cdccCombatPayElectionForBenefits" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">useSpouseCombatPay</Enum>
                    </Right>
                  </Equal>
                  <Equal>
                    <Left>
                      <Dependency module="cdcc" path="/cdccCombatPayElectionForBenefits" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">useBothCombatPay</Enum>
                    </Right>
                  </Equal>
                  <Equal>
                    <Left>
                      <Dependency module="cdcc" path="/cdccCombatPayElectionForBenefits" />
                    </Left>
                    <Right>
                      <Enum optionsPath="/combatPayOptions">useSpouseNotPrimaryCombatPay</Enum>
                    </Right>
                  </Equal>
                </Any>
              </All>
            </When>
            <Then>
              <Dependency module="formW2s" path="/MFJSpouseCombatPay" />
            </Then>
          </Case>
          <Case>
            <When>
              <!-- They have made a choice, but that choice did not include including secondary combat pay -->
              <IsComplete>
                <Dependency module="cdcc" path="/cdccCombatPayElectionForBenefits" />
              </IsComplete>
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
        <!-- Intentionally leave this undefined if there is combat pay but no decision is made -->
      </Derived>
    </Fact>

    <Fact path="/cdccPrimaryEarnedIncomeWithCombatPayForCredits">
      <Export downstreamFacts="true" />

      <Derived>
        <Add>
          <Dependency path="/primaryFilerEmployerIncomeSubtotalBase" />
          <Dependency path="/cdccPrimaryFilerCombatPayForCredits" />
        </Add>
      </Derived>
    </Fact>

    <Fact path="/cdccSecondaryEarnedIncomeWithCombatPayForCredits">
      <Export downstreamFacts="true" />

      <Derived>
        <Add>
          <Dependency path="/secondaryFilerEmployerIncomeSubtotalBase" />
          <Dependency path="/cdccSecondaryFilerCombatPayForCredits" />
        </Add>
      </Derived>
    </Fact>

    <Fact path="/cdccPrimaryTaxableBenefitsAllocationToMatchSecondary">
      <Derived>
        <LesserOf>
          <Subtract>
            <Minuend>
              <Dependency path="/cdccSecondaryEarnedIncomeWithCombatPayForCredits" />
            </Minuend>
            <Subtrahends>
              <Dependency path="/cdccPrimaryEarnedIncomeWithCombatPayForCredits" />
            </Subtrahends>
          </Subtract>
        </LesserOf>
      </Derived>
    </Fact>

    <Fact path="/cdccSecondaryTaxableBenefitsAllocationToMatchPrimary">
      <Derived>
        <Subtract>
          <Minuend>
            <Dependency path="/cdccPrimaryEarnedIncomeWithCombatPayForCredits" />
          </Minuend>
          <Subtrahends>
            <Dependency path="/cdccSecondaryEarnedIncomeWithCombatPayForCredits" />
          </Subtrahends>
        </Subtract>
      </Derived>
    </Fact>

    <Fact path="/cdccPrimaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits">
      <Export downstreamFacts="true" />

      <Derived>
        <LesserOf>
          <Dependency path="/taxableDependentCare" />
          <!-- They can only adjust their income by up to the benefits amount provided by their employer -->
          <Dependency module="cdcc" path="/cdccPrimaryFilerDependentCareBenefitsAmount" />
        </LesserOf>
      </Derived>
    </Fact>

    <Fact path="/cdccSecondaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits">
      <Export downstreamFacts="true" />

      <Derived>
        <LesserOf>
          <Dependency path="/taxableDependentCare" />
          <!-- They can only adjust their income by up to the benefits amount provided by their employer -->
          <Dependency module="cdcc" path="/cdccSecondaryFilerDependentCareBenefitsAmount" />
        </LesserOf>
      </Derived>
    </Fact>

    <Fact path="/cdccAllTaxableDependentCareBenefitsShouldBeAddedtoPrimaryEarnedIncome">
      <Derived>
        <All>
          <Dependency module="cdcc" path="/hasReportedPrimaryFilerDependentCareBenefits" />
          <Any>
            <!-- The earned income adjustments don't need to be split unless the secondary filer also has a nonzero dependent care benefits amount -->
            <Not>
              <All>
                <Dependency module="filingStatus" path="/isFilingStatusMFJ" />
                <Dependency module="cdcc" path="/hasReportedSecondaryFilerDependentCareBenefits" />
              </All>
            </Not>
            <!-- The primary earned income would still be the limit for credits, even with the maximum possible allocation -->
            <GreaterThanOrEqual>
              <Left>
                <Dependency path="/cdccPrimaryTaxableBenefitsAllocationToMatchSecondary" />
              </Left>
              <Right>
                <Add>
                  <Dependency path="/cdccPrimaryEarnedIncomeWithCombatPayForCredits" />
                  <Dependency path="/cdccPrimaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits" />
                </Add>
              </Right>
            </GreaterThanOrEqual>
            <All>
              <!-- Primary earned income is less than or equal to secondary earned income-->
              <LessThanOrEqual>
                <Left>
                  <Dependency path="/cdccPrimaryEarnedIncomeWithCombatPayForCredits" />
                </Left>
                <Right>
                  <Dependency path="/cdccSecondaryEarnedIncomeWithCombatPayForCredits" />
                </Right>
              </LessThanOrEqual>
              <!-- Fully allocating the taxable dependent care benefits to the primary filer would ensure the maximim credit  -->
              <GreaterThanOrEqual>
                <Left>
                  <LesserOf>
                    <Dependency path="/cdccSecondaryEarnedIncomeWithCombatPayForCredits" />
                    <Add>
                      <Dependency path="/cdccPrimaryEarnedIncomeWithCombatPayForCredits" />
                      <Dependency path="/cdccPrimaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits" />
                    </Add>
                  </LesserOf>
                </Left>
                <Right>
                  <Dependency module="cdcc" path="/cdccSmallerOfTotalQualifyingExpensesAmount" />
                </Right>
              </GreaterThanOrEqual>

	      <!-- SecondaryEarnedIncome must not be smaller than the composite primary earned income -->
              <Not>
                <LessThan>
                  <Left>
                    <Dependency path="/cdccSecondaryEarnedIncomeWithCombatPayForCredits" />
                  </Left>
                  <Right>
                    <Add>
                      <Dependency path="/cdccPrimaryEarnedIncomeWithCombatPayForCredits" />
                      <Dependency path="/cdccPrimaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits" />
                    </Add>
                  </Right>
                </LessThan>
              </Not>
            </All>
          </Any>
        </All>
      </Derived>
    </Fact>

    <Fact path="/cdccAllTaxableDependentCareBenefitsShouldBeAddedtoSecondaryEarnedIncome">

      <Derived>
        <All>
          <Dependency module="cdcc" path="/hasReportedSecondaryFilerDependentCareBenefits" />
          <Any>
            <!-- The earned income adjustments don't need to be split unless the primary filer also has a nonzero dependent care benefits amount -->
            <Not>
              <Dependency module="cdcc" path="/hasReportedPrimaryFilerDependentCareBenefits" />
            </Not>
            <!-- The secondary earned income would still be the limit for credits, even with the maximum possible allocation -->
            <GreaterThanOrEqual>
              <Left>
                <Dependency path="/cdccSecondaryTaxableBenefitsAllocationToMatchPrimary" />
              </Left>
              <Right>
                <Add>
                  <Dependency path="/cdccSecondaryEarnedIncomeWithCombatPayForCredits" />
                  <Dependency path="/cdccSecondaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits" />
                </Add>
              </Right>
            </GreaterThanOrEqual>
            <All>
              <!-- Secondary earned income is less than primary earned income-->
              <LessThan>
                <Left>
                  <Dependency path="/cdccSecondaryEarnedIncomeWithCombatPayForCredits" />
                </Left>
                <Right>
                  <Dependency path="/cdccPrimaryEarnedIncomeWithCombatPayForCredits" />
                </Right>
              </LessThan>
              <!-- Fully allocating the taxable dependent care benefits to the secondary filer would ensure the maximim credit  -->
              <GreaterThanOrEqual>
                <Left>
                  <LesserOf>
                    <Dependency path="/cdccPrimaryEarnedIncomeWithCombatPayForCredits" />
                    <Add>
                      <Dependency path="/cdccSecondaryEarnedIncomeWithCombatPayForCredits" />
                      <Dependency path="/cdccSecondaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits" />
                    </Add>
                  </LesserOf>
                </Left>
                <Right>
                  <Dependency module="cdcc" path="/cdccSmallerOfTotalQualifyingExpensesAmount" />
                </Right>
              </GreaterThanOrEqual>
	      <!-- SecondaryEarnedIncome must not be smaller than the composite primary earned income -->
              <Not>
                <LessThan>
                  <Left>
                    <Dependency path="/cdccPrimaryEarnedIncomeWithCombatPayForCredits" />
                  </Left>
                  <Right>
                    <Add>
                      <Dependency path="/cdccSecondaryEarnedIncomeWithCombatPayForCredits" />
                      <Dependency path="/cdccSecondaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits" />
                    </Add>
                  </Right>
                </LessThan>
              </Not>
            </All>
          </Any>
        </All>
      </Derived>
    </Fact>

    <Fact path="/cdccPrimaryFilerTaxableBenefits">
      <Description>
        Taxable Dependent Care Benefits for the purposes of determining Primary Filer's Earned Income for
        CDCC
      </Description>

      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="/cdccAllTaxableDependentCareBenefitsShouldBeAddedtoPrimaryEarnedIncome" />
            </When>
            <Then>
              <!-- Hooray!  No weird math needed. -->
              <Dependency path="/cdccPrimaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits" />
            </Then>
          </Case>
          <Case>
            <When>
              <GreaterThan>
                <Left>
                  <Dependency path="/taxableDependentCare" />
                </Left>
                <Right>
                  <Dependency path="/cdccSecondaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits" />
                </Right>
              </GreaterThan>
            </When>
            <Then>
              <!-- This shouldn't impact calculations, but for consistency, we make sure any remaining benefits are allocated here -->
              <LesserOf>
                <Dependency path="/cdccPrimaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits" />
                <Subtract>
                  <Minuend>
                    <Dependency path="/taxableDependentCare" />
                  </Minuend>
                  <Subtrahends>
                    <Dependency path="/cdccSecondaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits" />
                  </Subtrahends>
                </Subtract>
              </LesserOf>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>
    <Fact path="/cdccSecondaryFilerTaxableBenefits">
      <Description>
        Taxable Dependent Care Benefits for the purposes of determining Secondary Filer's Earned Income for
        CDCC
      </Description>

      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency path="/cdccAllTaxableDependentCareBenefitsShouldBeAddedtoSecondaryEarnedIncome" />
            </When>
            <Then>
              <!-- Hooray!  No weird math needed. -->
              <Dependency path="/cdccSecondaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits" />
            </Then>
          </Case>
          <Case>
            <When>
              <GreaterThan>
                <Left>
                  <Dependency path="/taxableDependentCare" />
                </Left>
                <Right>
                  <Dependency path="/cdccPrimaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits" />
                </Right>
              </GreaterThan>
            </When>
            <Then>
              <!-- This shouldn't impact calculations, but for consistency, we make sure any remaining benefits are allocated here -->
              <LesserOf>
                <Dependency path="/cdccSecondaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits" />
                <Subtract>
                  <Minuend>
                    <Dependency path="/taxableDependentCare" />
                  </Minuend>
                  <Subtrahends>
                    <Dependency path="/cdccPrimaryFilerMaximumEarnedIncomeAdjustmentFromTaxableBenefits" />
                  </Subtrahends>
                </Subtract>
              </LesserOf>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/cdccEarnedIncomePrimaryFilerLine4">
      <Name>CDCC Earned Income elections for primary filer</Name>
      <Description>
        Earned income as defined for Child and Dependent Care Credit.
        Reported on Form 2441 line 4
      </Description>
      <Export downstreamFacts="true" mef="true" />

      <Derived>
        <Round>
          <Add>
            <Dependency path="/cdccPrimaryEarnedIncomeWithCombatPayForCredits" />
            <Dependency path="/cdccPrimaryFilerTaxableBenefits" />
          </Add>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/cdccEarnedIncomeSecondaryFilerPartII">
      <Name>CDCC earned income for secondary filer</Name>
      <Description>
        Secondary Filer's Earned income as defined for Child and Dependent Care Credit.
      </Description>

      <Derived>
        <Round>
          <Add>
            <Dependency path="/cdccSecondaryEarnedIncomeWithCombatPayForCredits" />
            <Dependency path="/cdccSecondaryFilerTaxableBenefits" />
          </Add>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/cdccEarnedIncomeLine5">
      <Description>
        Secondary Filer's Earned income as defined for Child and Dependent Care Credit, if applicable.

        Form
        2441, line 5
      </Description>
      <Export downstreamFacts="true" mef="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency module="filingStatus" path="/isFilingStatusMFJ" />
            </When>
            <Then>
              <Dependency path="/cdccEarnedIncomeSecondaryFilerPartII" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dependency path="/cdccEarnedIncomePrimaryFilerLine4" />
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/cdccEarnedIncomePrimaryFilerLine18">
      <Name>Primary filer earned income as defined for CDCC line 18</Name>
      <Description>
        Earned income as defined for Child and Dependent Care Credit pay minus taxable dependent care
        benefits.
        Form 2441, line 18
      </Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Round>
          <Add>
            <Dependency path="/primaryFilerEmployerIncomeSubtotalBase" />
            <Dependency path="/cdccPrimaryFilerCombatPayForBenefits" />
            <!-- OUT OF SCOPE: earned income calculations when student/disabled -->
            <!-- OUT OF SCOPE: earned income from Schedule SE (Form 1040) -->
            <!-- OUT OF SCOPE: earned income from Schedule C (Form 1040) -->
            <!--
            OUT OF SCOPE: earned income calculations when student/disabled
            <Dependency path="/primaryFilerIncomeForMonthsDisabledOrInSchool" />
          -->
          </Add>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/cdccEarnedIncomeSecondaryFilerPartIII">
      <Name>Secondary filer earned income as defined for CDCC</Name>
      <Description>Earned income as defined for Child and Dependent Care Credit minus dependent care
        benefits.
        This value
        is reported on part III, line 19 of form 2441 if MFJ, used to
        calculate CDCC.</Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Round>
          <Add>
            <Dependency path="/secondaryFilerEmployerIncomeSubtotalBase" />
            <Dependency path="/cdccSecondaryFilerCombatPayForBenefits" />
            <!-- OUT OF SCOPE: earned income calculations when student/disabled -->
            <!-- OUT OF SCOPE: earned income from Schedule SE (Form 1040) -->
            <!-- OUT OF SCOPE: earned income from Schedule C (Form 1040) -->
          <!--
            OUT OF SCOPE: earned income calculations when student/disabled
            <Dependency path="/secondaryFilerIncomeForMonthsDisabledOrInSchool" />
          -->
          </Add>
        </Round>
      </Derived>
    </Fact>

    <Fact path="/cdccEarnedIncomeLine19">
      <Description> Earned income for form 2441, part III, line 19 depending on filing status
        If MFJ, use the spouse
        earned income + combat pay if elected
        If single or HOH or mfs unmarried, use the primary filer earned income +
        combat pay if elected
        If mfs married, use the written in spouse earned income
      </Description>
      <Export downstreamFacts="true" />

      <Derived>
        <Switch>
          <Case>
            <When>
              <Any>
                <Dependency module="filingStatus" path="/isFilingStatusSingle" />
                <Dependency module="filingStatus" path="/isFilingStatusHOH" />
                <Dependency module="filers" path="/mfsButEligibleForCdcc" />
              </Any>
            </When>
            <Then>
              <Dependency path="/cdccEarnedIncomePrimaryFilerLine18" />
            </Then>
          </Case>
          <Case>
            <When>
              <Dependency module="filers" path="/mfsNotEligibleForCdcc" />
            </When>
            <Then>
              <Dependency path="/mfsSpouseEarnedIncome" />
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dependency path="/cdccEarnedIncomeSecondaryFilerPartIII" />
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/writableMfsSpouseEarnedIncome">
      <Description>MFS spouse's earned income as reported by the TP for the sake of determining whether they can exclude
        any dependent care benefits</Description>

      <Writable>
        <Dollar />
        <Limit type="Min">
          <Dollar> 0.00 </Dollar>
        </Limit>
      </Writable>
    </Fact>

    <Fact path="/mfsSpouseEarnedIncome">
      <Description>MFS spouse's earned income as reported by the TP for the sake of determining whether they can exclude
        any dependent care benefits</Description>

      <Derived>
        <Switch>
          <Case>
            <When>
              <Dependency module="cdcc" path="/hasMfjSpouseEarnedIncome" />
            </When>
            <Then>
              <Round>
                <Dependency path="/writableMfsSpouseEarnedIncome" />
              </Round>
            </Then>
          </Case>
          <Case>
            <When>
              <True />
            </When>
            <Then>
              <Dollar>0</Dollar>
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/cdccDisabledOrInSchoolIncomePerMonthWithMultipleQps">
      <Description>Amount per month considered income for a taxpayer who was disabled or a student. Used for the purpose
        of determining earned income for CDCC</Description>

      <Derived>
        <Dollar>500</Dollar>
      </Derived>
    </Fact>

    <Fact path="/cdccDisabledOrInSchoolIncomePerMonthWithOneQp">
      <Description>Amount per month considered income for a taxpayer who was disabled or a student. Used for the purpose
        of determining earned income for CDCC</Description>

      <Derived>
        <Dollar>250</Dollar>
      </Derived>
    </Fact>

    <Fact path="/monthlyIncomeIfDisabledOrInSchool">
      <Description>The rate to use per month as income for a taxpayer or spouse who was disabled or a student. This is
        dependent on if they have one or more than one qualifying person for CDCC.</Description>

      <Derived>
        <Switch>
          <Case>
            <When>
              <GreaterThan>
                <Left>
                  <Dependency module="cdcc" path="/cdccCountOfQualifyingPersons" />
                </Left>
                <Right>
                  <Int>1</Int>
                </Right>
              </GreaterThan>
            </When>
            <Then>
              <Dependency path="/cdccDisabledOrInSchoolIncomePerMonthWithMultipleQps" />
            </Then>
          </Case>
          <Case>
            <When>
              <Equal>
                <Left>
                  <Dependency module="cdcc" path="/cdccCountOfQualifyingPersons" />
                </Left>
                <Right>
                  <Int>1</Int>
                </Right>
              </Equal>
            </When>
            <Then>
              <Dependency path="/cdccDisabledOrInSchoolIncomePerMonthWithOneQp" />
            </Then>
          </Case>
        </Switch>
      </Derived>
    </Fact>

    <Fact path="/primaryFilerIncomeForMonthsDisabledOrInSchool">
      <Description>Total income assigned to primary filer for months they were disabled or in school. Used for CDCC</Description>

      <Derived>
        <Multiply>
          <Dependency module="filers" path="/primaryFiler/cdccMonthsDisabledOrInSchool" />
          <Dependency path="/monthlyIncomeIfDisabledOrInSchool" />
        </Multiply>
      </Derived>
    </Fact>

    <Fact path="/secondaryFilerIncomeForMonthsDisabledOrInSchool">
      <Description>Total income assigned to secondary filer for months they were disabled or in school. Used for CDCC</Description>

      <Derived>
        <Multiply>
          <Dependency module="filers" path="/secondaryFiler/cdccMonthsDisabledOrInSchool" />
          <Dependency path="/monthlyIncomeIfDisabledOrInSchool" />
        </Multiply>
      </Derived>
    </Fact>

    <Fact path="/cdccMaximumCreditRequiresUnsupportedCalculation">
      <Export downstreamFacts="true" />

      <Derived>
        <Not>
          <Any>
            <Dependency path="/cdccAllTaxableDependentCareBenefitsShouldBeAddedtoPrimaryEarnedIncome" />
            <Dependency path="/cdccAllTaxableDependentCareBenefitsShouldBeAddedtoSecondaryEarnedIncome" />
          </Any>
        </Not>
      </Derived>
    </Fact>
  </Facts>
</FactDictionaryModule>
